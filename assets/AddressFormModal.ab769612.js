import{f as m,n as f}from"./index.62d69ed7.js";import{P as p,a as n}from"./PhoneInput.22ee1609.js";var c=function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"modal-card address-modal"},[s("ValidationObserver",{ref:"observer",attrs:{tag:"form"},on:{submit:function(t){return t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[s("div",{staticClass:"modal-card-head"},[s("div",{staticClass:"modal-card-title"},[e._v(e._s(e.heading))])]),s("div",{staticClass:"modal-card-body"},[s("div",{staticClass:"columns is-mobile is-multiline"},[e.showSaveInAddressBook?s("div",{staticClass:"column"},[s("b-switch",{model:{value:e.form.save_in_address_book,callback:function(t){e.$set(e.form,"save_in_address_book",t)},expression:"form.save_in_address_book"}},[e._v(e._s(e.$t("customer.common.save-in-address-book")))])],1):e._e(),e.showCompany?s("div",{staticClass:"column"},[s("b-switch",{model:{value:e.isCompany,callback:function(t){e.isCompany=t},expression:"isCompany"}},[e._v(e._s(e.$t("customer.common.company")))])],1):e._e(),e.showDefaults?s("div",{staticClass:"column"},[s("b-switch",{model:{value:e.form.default_shipping,callback:function(t){e.$set(e.form,"default_shipping",t)},expression:"form.default_shipping"}},[e._v(e._s(e.$t("customer.common.default-shipping")))])],1):e._e(),e.showDefaults?s("div",{staticClass:"column"},[s("b-switch",{model:{value:e.form.default_billing,callback:function(t){e.$set(e.form,"default_billing",t)},expression:"form.default_billing"}},[e._v(e._s(e.$t("customer.common.default-billing")))])],1):e._e()]),e.isCompany?[s("ValidationProvider",{attrs:{name:e.$t("customer.common.company"),rules:"required",slim:""}},[s("b-field",{attrs:{type:{"is-danger":e.errors[0],"is-success":e.valid},message:e.errors,expanded:""},scopedSlots:e._u([{key:"default",fn:function(t){return t.errors,t.valid,[s("b-input",{attrs:{placeholder:e.$t("customer.common.company"),name:"company"},model:{value:e.form.company,callback:function(r){e.$set(e.form,"company",r)},expression:"form.company"}})]}}],null,!1,1635356032)})],1),s("ValidationProvider",{attrs:{name:e.$t("customer.common.vat_id"),slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":e.form.vat_id&&i},message:r,expanded:""}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.vat-number"),name:"vat_id"},model:{value:e.form.vat_id,callback:function(o){e.$set(e.form,"vat_id",o)},expression:"form.vat_id"}})],1)]}}],null,!1,4265776488)})]:e._e(),s("ValidationProvider",{attrs:{name:e.$t("customer.common.first-name"),rules:"required",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.first-name"),name:"firstname"},model:{value:e.form.firstname,callback:function(o){e.$set(e.form,"firstname",o)},expression:"form.firstname"}})],1)]}}])}),s("ValidationProvider",{attrs:{name:e.$t("customer.common.last-name"),rules:"required",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.last-name"),name:"lastname"},model:{value:e.form.lastname,callback:function(o){e.$set(e.form,"lastname",o)},expression:"form.lastname"}})],1)]}}])}),s("ValidationProvider",{attrs:{name:e.$t("customer.common.country"),mode:"lazy",rules:"required",slim:"",vid:"country_id"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-select",{staticClass:"is-custom",attrs:{placeholder:e.$t("customer.common.country-placeholder"),expanded:""},model:{value:e.form.country_id,callback:function(o){e.$set(e.form,"country_id",o)},expression:"form.country_id"}},e._l(e.filteredCountries,function(o){return s("option",{key:`country-${o.code}`,domProps:{value:o.code}},[e._v(" "+e._s(o.fullName)+" ")])}),0)],1)]}}])}),e.isVisibleRegions?[s("ValidationProvider",{directives:[{name:"show",rawName:"v-show",value:e.regions.length,expression:"regions.length"}],attrs:{name:e.$t("customer.common.region"),debounce:100,rules:{required:e.regions.length>0},slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-select",{staticClass:"is-custom",attrs:{placeholder:e.$t("customer.common.region-placeholder"),loading:e.regionsLoading,name:"region_id",expanded:""},model:{value:e.regionIdComputed,callback:function(o){e.regionIdComputed=o},expression:"regionIdComputed"}},e._l(e.regions,function(o){return s("option",{key:o.id,domProps:{value:o.id}},[e._v(" "+e._s(o.name)+" ")])}),0)],1)]}}],null,!1,2044178980)}),s("ValidationProvider",{directives:[{name:"show",rawName:"v-show",value:!e.regions.length&&!e.regionsLoading,expression:"!regions.length && !regionsLoading"}],attrs:{name:e.$t("customer.common.region"),rules:{required:!e.regions.length},slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.region-input-placeholder"),name:"region"},model:{value:e.form.region,callback:function(o){e.$set(e.form,"region",o)},expression:"form.region"}})],1)]}}],null,!1,795910230)})]:e._e(),s("ValidationProvider",{attrs:{name:e.$t("customer.common.city"),rules:"required",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.city"),name:"city"},model:{value:e.form.city,callback:function(o){e.$set(e.form,"city",typeof o=="string"?o.trim():o)},expression:"form.city"}})],1)]}}])}),s("ValidationProvider",{attrs:{name:e.$t("customer.common.postcode"),rules:"required|min:3",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.postcode"),name:"postcode"},model:{value:e.form.postcode,callback:function(o){e.$set(e.form,"postcode",typeof o=="string"?o.trim():o)},expression:"form.postcode"}})],1)]}}])}),s("ValidationProvider",{attrs:{name:e.$t("customer.common.street"),rules:"required",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i&&e.form.street[0]},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.street"),name:"street[0]"},model:{value:e.form.street[0],callback:function(o){e.$set(e.form.street,0,typeof o=="string"?o.trim():o)},expression:"form.street[0]"}})],1)]}}])}),s("ValidationProvider",{attrs:{name:e.$t("customer.common.street")+" 2",slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i&&e.form.street[1]},message:r}},[s("b-input",{attrs:{placeholder:e.$t("customer.common.street")+" 2",name:"street[1]"},model:{value:e.form.street[1],callback:function(o){e.$set(e.form.street,1,typeof o=="string"?o.trim():o)},expression:"form.street[1]"}})],1)]}}])}),s("ValidationProvider",{ref:"phone",attrs:{name:e.$t("customer.common.phone"),rules:"required",debounce:200,slim:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.errors,i=t.valid;return[s("b-field",{attrs:{type:{"is-danger":r[0],"is-success":i},message:r}},[s("phone-input",{attrs:{value:e.nationalPhone,country:e.form.country_id,"input-props":{id:"telephone"},name:"telephone"},on:{input:e.onPhoneInput}})],1)]}}])})],2),s("div",{staticClass:"modal-card-foot"},[s("button",{staticClass:"button is-fullwidth is-text",attrs:{type:"button"},on:{click:e.handleCancel}},[e._v(" "+e._s(e.$t("common.cancel"))+" ")]),s("button",{staticClass:"button is-fullwidth is-primary",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("common.save"))+" ")])])]),s("b-loading",{attrs:{"is-full-page":!1,active:e.loading}})],1)},h=[];c._withStripped=!0;const l=m.getCountriesArray(),v={components:{PhoneInput:p},props:{showDefaults:{type:Boolean,default:!0},showCompany:{type:Boolean,default:!1},showSaveInAddressBook:{type:Boolean,default:!1},title:{type:String,default:()=>""},address:{type:Object,default:()=>Object.create(null)}},data(){return{form:{prefix:"",suffix:"",firstname:"",lastname:"",middlename:"",country_id:null,region:"",region_id:null,city:"",postcode:"",street:[""],telephone:"",fax:"",company:"",vat_id:"",save_in_address_book:!0,default_shipping:!1,default_billing:!1},loading:!1,isCompany:!1,regions:[],regionsLoading:!1,countryName:"",nationalPhone:"",isPhoneValid:!0}},computed:{heading(){return this.title?this.title:this.$t(this.address.id?"customer.address-book.edit":"customer.address-book.new")},regionIdComputed:{get(){return this.form.region_id||null},set(e){this.form.region_id=e}},filteredCountries(){return this.countryName?l.filter(e=>e.fullName.toLowerCase().indexOf(this.countryName.toLowerCase())>=0):l},isVisibleRegions(){return this.form.country_id&&n.includes(this.form.country_id)}},watch:{"form.country_id":{immediate:!0,async handler(e,a){if(a&&(this.form.region_id=null),this.regions=[],e){if(!n.includes(e))return;this.regionsLoading=!0;try{const{data:s}=await m.loadCountry(e);s.available_regions&&(this.regions=s.available_regions)}catch{}this.regionsLoading=!1}}},"form.telephone":function(e){this.nationalPhone||(this.nationalPhone=e)},isCompany(e){e===!1&&(this.form.company=null,this.form.vat_id=null)}},created(){this.address.firstname!==void 0&&(this.form.prefix=this.address.prefix,this.form.suffix=this.address.suffix,this.form.firstname=this.address.firstname,this.form.lastname=this.address.lastname,this.form.middlename=this.address.middlename,this.form.company=this.address.company,this.form.vat_id=this.address.vat_id,this.form.country_id=this.address.country_id,this.address.region&&(this.form.region=this.address.region instanceof String?this.address.region:this.address.region.region),this.form.region_id=this.address.region_id,this.form.postcode=this.address.postcode,this.form.telephone=this.address.telephone,this.form.fax=this.address.fax,this.form.city=this.address.city,this.form.street=Object.assign([],this.address.street),this.form.default_shipping=!!this.address.default_shipping,this.form.default_billing=!!this.address.default_billing,this.form.save_in_address_book=!!this.address.save_in_address_book,this.isCompany=!!this.address.company||!!this.address.vat_id)},mounted(){this.form.country_id&&this.$refs.observer.validate()},methods:{handleSubmit(){this.$refs.observer.validate().then(e=>{e&&this.$emit("update",this)})},handleCancel(){this.$emit("close")},onCountrySelect(e){this.form.country_id=e,this.$refs.country_id.validate()},onPhoneInput(e,{possible:a,phone:s,countryCallingCode:t}){s?(this.isPhoneValid=!!a,this.form.telephone=`+${t}${s}`,this.nationalPhone=s):(this.form.telephone=e,this.nationalPhone="",this.isPhoneValid=!1),this.form.telephone&&!this.isPhoneValid?this.$refs.phone.setErrors([this.$t("checkout.shipping-details.delivery-address.phone-invalid")]):this.$refs.phone.validate(this.form.telephone)}}},d={};var u=f(v,c,h,!1,g,null,null,null);function g(e){for(let a in d)this[a]=d[a]}u.options.__file="src/components/AddressFormModal.vue";var b=function(){return u.exports}();export{b as default};
